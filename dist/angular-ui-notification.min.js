/**
 * angular-ui-notification - Angular.js service providing simple notifications using Bootstrap 3 styles with css transitions for animating
 * @author Alex_Crack
 * @version v0.2.0
 * @link https://github.com/alexcrack/angular-ui-notification
 * @license MIT
 */
angular.module("ui-notification",[]),angular.module("ui-notification").provider("Notification",function(){this.options={delay:5e3,startTop:10,startRight:10,verticalSpacing:10,horizontalSpacing:10,positionX:"right",positionY:"top",replaceMessage:!1,templateUrl:"angular-ui-notification.html",onClose:void 0,closeOnClick:!0,maxCount:0,container:"body"},this.setOptions=function(e){if(!angular.isObject(e))throw new Error("Options should be an object!");this.options=angular.extend({},this.options,e)},this.$get=["$timeout","$http","$compile","$templateCache","$rootScope","$injector","$sce","$q","$window",function(e,t,n,i,o,s,a,l,r){var c=this.options,p=c.startTop,u=c.startRight,d=c.verticalSpacing,f=c.horizontalSpacing,m=c.delay,g=[],h=!1,C=function(s,C){var y=l.defer();"object"!=typeof s&&(s={message:s}),s.scope=s.scope?s.scope:o,s.template=s.templateUrl?s.templateUrl:c.templateUrl,s.delay=angular.isUndefined(s.delay)?m:s.delay,s.type=C||c.type||"",s.positionY=s.positionY?s.positionY:c.positionY,s.positionX=s.positionX?s.positionX:c.positionX,s.replaceMessage=s.replaceMessage?s.replaceMessage:c.replaceMessage,s.onClose=s.onClose?s.onClose:c.onClose,s.closeOnClick=null!==s.closeOnClick&&void 0!==s.closeOnClick?s.closeOnClick:c.closeOnClick,s.container=s.container?s.container:c.container;var v=document.querySelector(s.container)||document.body;return t.get(s.template,{cache:i}).success(function(t){function i(e){["-webkit-transition","-o-transition","transition"].forEach(function(t){C.css(t,e)})}var o=s.scope.$new();o.message=a.trustAsHtml(s.message),o.title=a.trustAsHtml(s.title),o.t=s.type.substr(0,1),o.delay=s.delay,o.onClose=s.onClose;var l=v.getBoundingClientRect(),m=function(){l=v.getBoundingClientRect(),p=l.top+c.startTop;for(var e=0,t=0,n=p,i=u,o=[],a=g.length-1;a>=0;a--){var r=g[a];if(s.replaceMessage&&a<g.length-1)r.addClass("killed");else{var m=parseInt(r[0].offsetHeight),h=parseInt(r[0].offsetWidth),C=o[r._positionY+r._positionX];y+m>window.innerHeight&&(C=p,t++,e=0);var y=n=C?0===e?C:C+d:p,k=i+t*(f+h);r.css(r._positionY,y+"px"),"center"==r._positionX?r.css("left",parseInt(l.left+l.width/2-h/2)+"px"):r.css(r._positionX,k+"px"),o[r._positionY+r._positionX]=y+m,c.maxCount>0&&g.length>c.maxCount&&0===a&&r.scope().kill(!0),e++}}},C=n(t)(o);C._positionY=s.positionY,C._positionX=s.positionX,C.addClass(s.type);var k=function(e){e=e.originalEvent||e,("click"===e.type||"opacity"===e.propertyName&&e.elapsedTime>=1)&&(o.onClose&&o.$apply(o.onClose(C)),C.remove(),g.splice(g.indexOf(C),1),o.$destroy(),m())};s.closeOnClick&&(C.addClass("clickable"),C.bind("click",k)),C.bind("webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",k),angular.isNumber(s.delay)&&e(function(){C.addClass("killed")},s.delay),i("none"),angular.element(v).append(C);var b=-(parseInt(C[0].offsetHeight)+50);if(C.css(C._positionY,b+"px"),g.push(C),"center"==s.positionX){var w=parseInt(C[0].offsetWidth);C.css("left",parseInt(l.left+l.width/2-w/2)+"px")}e(function(){i("")}),o._templateElement=C,o.kill=function(t){t?(o.onClose&&o.$apply(o.onClose(o._templateElement)),g.splice(g.indexOf(o._templateElement),1),o._templateElement.remove(),o.$destroy(),e(m)):o._templateElement.addClass("killed")},e(m),h||(angular.element(r).bind("resize",function(t){e(m)}),h=!0),y.resolve(o)}).error(function(e){throw new Error("Template ("+s.template+") could not be loaded. "+e)}),y.promise};return C.primary=function(e){return this(e,"primary")},C.error=function(e){return this(e,"error")},C.success=function(e){return this(e,"success")},C.info=function(e){return this(e,"info")},C.warning=function(e){return this(e,"warning")},C.clearAll=function(){angular.forEach(g,function(e){e.addClass("killed")})},C}]}),angular.module("ui-notification").run(["$templateCache",function(e){e.put("angular-ui-notification.html",'<div class="ui-notification"><h3 ng-show="title" ng-bind-html="title"></h3><div class="message" ng-bind-html="message"></div></div>')}]);